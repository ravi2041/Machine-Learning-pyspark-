users = als_dataset.select(als.getUserCol()).filter(als_dataset["user_label_int"].rlike("14[0-5]")).distinct()
usersubSetRecs = model.recommendForUserSubset(users, 10)
usersubSetRecs.show(10, False)

# +--------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
# |user_label_int|recommendations                                                                                                                                                             |
# +--------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
# |143           |[[10, 0.7991416], [7, 0.77103287], [0, 0.7623659], [11, 0.75945157], [17, 0.7496676], [9, 0.6951245], [44, 0.67278486], [49, 0.66093284], [26, 0.655926], [109, 0.64585423]]|
# +--------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------+


def recommend(recommendations):
	items = []
	for item, rating in recommendations:
		items.append(item)
	return items

udf_recommend = F.udf(lambda recommendations: recommend(recommendations), ArrayType(IntegerType()))



temp = (
	usersubSetRecs.withColumn('recommends', udf_recommend(F.col('recommendations')))
	.select(['user_label_int', 'recommends'])
	)

test_array = test.groupBy("user_label_int").agg(F.collect_list("song_label_int"))

#test_array.show(5)

# +--------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
# |user_label_int|collect_list(song_label_int)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
# +--------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
# |12            |[6431, 110184, 13945, 4951, 3141, 14810, 35054, 1083, 142751, 24774, 10851, 358, 20267, 42592, 57106, 88991, 174717, 18451, 5435, 26983, 20359, 15552, 7463, 104870, 12092, 18889, 15312, 89899, 1237, 9750, 33867, 7623, 91611, 34012, 237, 42688, 10834, 16088, 8812, 165601, 79, 1449, 8873, 2622, 4569, 28, 1728, 131404, 24124, 3226, 7286, 5872, 6450, 13872, 2647, 33410, 165855, 6175, 12361, 52747, 160492, 25538, 338, 36164, 10778, 10584, 14892, 14384, 38305, 476, 215331, 87909, 9678, 5680, 87066, 56152, 12159, 183038, 21022, 7371, 53010, 13747, 6044, 6, 5852, 46574, 118913, 27401, 164154, 10003, 42337, 11675, 25909, 10450, 10951, 8010, 7543, 1146, 43825, 6721, 20007, 1200, 17721, 67, 56715, 10176, 34002, 4265, 160489, 169, 15209, 196931, 70330, 5455, 18369, 121586, 19590, 49153, 34, 14096, 61448, 5945, 74898, 39706, 25894, 16328, 2579, 22923, 50857, 11823, 11387, 38752, 40730, 18780, 58279, 372, 10453, 35611, 74007, 10144, 12260, 11112, 4730, 2129, 7310, 35510, 12648, 4484, 15685, 33099, 30470, 22850, 17061, 10071, 68575, 5624, 17135, 17629, 1927, 13936, 72299, 8224, 27001, 25609, 68336, 267675, 13151, 36946, 544, 15249, 59425, 18721, 1566, 22502, 8745, 333, 9366, 19784, 56280, 11613, 39906, 7280, 14112, 4533, 40524, 11285, 2807, 14468, 14497, 46973, 10463, 52968, 138967, 10278, 118779, 2138, 303365, 431, 3341, 2833, 161684, 81902, 11663, 1741, 3515, 8497, 12594, 72104, 8607, 62502, 215354, 21839, 29259, 66422, 71331, 35439, 12280, 65656, 15869, 25204, 41954, 5363, 11625, 3134, 27606, 34847, 10477, 1811, 186, 145935, 202553, 2294, 167146, 627, 4773, 2104, 385, 5584, 4097, 30068, 4423, 13690, 9667, 3028, 37823, 54163, 16626, 16327, 2991, 68023, 32928, 147465, 8691, 8152, 33618, 26230, 13715, 12867, 19289, 29580, 9387, 35259, 24394, 12326, 11468, 96948, 8933, 5632, 24202, 676, 91399, 51492, 60358, 10711, 34176, 1362, 7196, 34042, 11232, 170, 16620, 10888, 9212, 14644, 38954, 34743, 73832, 153417, 60301, 20422, 16101, 34521, 940, 41340, 165505, 1745, 72905, 13631, 31124, 48440, 9218, 23192, 17603, 14161, 43109, 16108, 49242, 39403, 28934, 19923, 43659, 3583, 49638, 28054, 825, 17420, 3934, 1118, 129084, 21927, 35855, 180039, 24907, 178654, 6787, 92925, 16057, 67430, 17596, 455, 25877, 1507, 701, 54939, 8916, 55262, 35541, 44937, 641, 25222, 76365, 6686, 5269, 27823, 26022, 13817, 9372, 685, 57906, 186031, 1641, 13616, 33552, 16995, 158097, 4108, 38043, 24661, 12768, 12171, 119210, 6483, 63132, 27182, 303712, 18243, 170652, 29107, 40333, 30980, 55415, 5820, 31237, 63212, 17329, 30603, 507, 8710, 821, 7035, 41813, 20239]|
# |13            |[39976, 17757, 42161, 10388, 358, 12484, 2665, 14813, 31426, 15100, 323, 26466, 1681, 24312, 44365, 106926, 198130, 21657, 93644, 44757, 5799, 25123, 9304, 39760, 9881, 2871, 79236, 2382, 198556, 91782, 55549, 62649, 5610, 14253, 6174, 18954, 35594, 238579, 69904, 9588, 8871, 15823, 31586, 3293, 26423, 2297, 34823, 68899, 3203, 25252, 61048, 32477, 69582, 7610, 209894, 92725, 3802, 10756, 18569, 22165, 367388, 227941, 23995, 34785, 7991, 14973, 20305, 7957, 61830, 22368, 20557, 178142, 218470, 22680, 21605, 9013, 27744, 57802, 10051, 2848, 266897, 18024, 53865, 12249, 24992, 21327, 9678, 8356, 13506, 33451, 8843, 116467, 490, 20049, 513, 1725, 10200, 7357, 6070, 188932, 21851, 6301, 506, 8090, 22949, 4701, 47288, 2216, 2385, 4444, 38333, 1495, 43326, 315646, 33003, 15979, 16027, 35607, 159510, 6527, 31853, 35293, 2328, 35042, 178908, 39174, 158341, 9842, 7585, 1402, 9332, 93039, 113812, 191995, 123202, 42562, 132855, 30570, 42540, 23455, 91249, 41681, 58231, 6767, 69674, 21994, 59822, 40986, 19394, 25327, 60898, 2041, 12795, 17051, 16370, 70431, 31587, 8892, 12582, 88674, 282, 13111, 1501, 22997, 31764, 2225, 20258, 27294, 10295, 2152, 57587, 9729, 23459, 16137, 117237, 72131, 19403, 11533, 43754, 45, 23750, 9571, 45203, 12685, 23519, 212800, 59, 30216, 24060, 78635, 20745, 8744, 156320, 642, 27949, 1535, 46969, 251093, 5199, 725, 2891, 145874, 45107, 60363, 20755, 24416, 19160, 3601, 5205, 37683, 57073, 33228, 23237, 192976, 12129, 4341, 32564, 74404, 10054, 110321, 344, 9723, 11257, 8182, 64614, 38089, 8119, 12191, 168335, 10890, 31603, 11590, 45920, 5544, 7669, 207048, 202010, 41916, 4633, 48367, 6221, 30591, 8147, 33618, 10090, 812, 11462, 93892, 168004, 17873, 22793, 3244, 122582, 5314, 7600, 151850, 151800, 6284, 11996, 33470, 16546, 1548, 5506, 717, 203892, 90024, 26917, 21907, 2786, 102091, 114944, 2224, 49639, 22955, 83688, 11276, 11809, 7934, 22376, 7702, 112081, 15597, 30624, 9639, 18184, 73911, 214566, 59176, 1827, 78718, 5938, 20295, 13316, 110918, 23884, 107546, 63621, 25199, 54068, 22616, 8092, 70417, 20132, 24387, 1085, 6323, 47494, 32450, 51668, 9915, 39085, 1903, 14467, 37499, 13965, 65128, 25002, 7598, 19500, 14881, 1746, 39393, 17841, 4624, 11898, 8217, 7969, 12153, 122408, 14710, 118438, 38815, 18032, 29033, 3704, 58911, 11481, 8588, 20206, 10082, 23141, 13642, 21032, 10553, 35684, 3361, 34612, 86649, 6247, 25974, 16845, 6262, 20356, 2771, 27958, 52280, 1272, 18797, 58599, 4169, 68650, 22741, 5820, 8298, 3410, 26007, 207212, 18396, 11278, 9411, 4225, 15767, 6874, 23970]                      |
# |14            |[77141, 3637, 7195, 19, 7448, 11251, 197717, 14332, 24118, 11105, 5296, 5125, 91421, 4200, 15346, 10857, 156580, 6928, 3084, 18824, 62919, 156, 15517, 33040, 165827, 256, 54251, 4576, 3246, 8713, 116480, 8089, 10559, 159145, 8166, 19739, 20301, 807, 2455, 28, 11702, 3335, 66807, 69710, 20402, 14534, 51120, 5673, 22574, 10443, 30670, 14975, 3572, 27270, 40098, 160827, 3713, 762, 6412, 11386, 46340, 22183, 25538, 91, 52308, 9175, 18197, 132408, 103064, 4070, 23815, 13939, 22875, 1944, 26011, 1646, 22411, 38868, 5857, 20405, 93365, 25824, 83128, 24594, 107, 2134, 2956, 28117, 17090, 49321, 7218, 53240, 19662, 3445, 24516, 53928, 24564, 369, 7427, 16172, 1810, 64718, 24242, 42559, 16798, 70014, 4819, 25875, 31262, 64991, 267, 5431, 18463, 13819, 27310, 30276, 66483, 52946, 734, 43176, 68290, 124, 19582, 2473, 12647, 18895, 10195, 31347, 710, 19028, 34842, 86959, 37376, 8326, 48861, 3234, 7465, 14910, 1821, 1222, 44216, 23698, 16773, 33837, 70276, 12373, 1841, 39105, 1593, 2774, 238, 46385, 2572, 28325, 793, 1230, 3130, 2987, 1368, 77243, 11338, 19446, 34634, 23234, 6538, 18461, 37464, 669, 4583, 1767, 62515, 19067, 44465, 2283, 4301, 19720, 57401, 43294, 12301, 42033, 50, 431, 26850, 86988, 308, 7190, 6990, 11605, 214508, 110813, 167537, 1322, 5017, 834, 104892, 7385, 107016, 78, 13275, 6495, 5483, 3056, 30796, 5975, 31583, 9051, 1629, 23565, 2071, 14901, 498, 8804, 3866, 95118, 917, 865, 9796, 25093, 2577, 28466, 32617, 61395, 42801, 182130, 163515, 12024, 397, 5274, 14600, 3897, 150679, 69461, 14303, 38, 1923, 12997, 109675, 17776, 9505, 112961, 10086, 7314, 7, 31734, 1210, 1251, 32043, 7262, 66434, 6221, 36180, 14156, 64852, 28760, 7549, 6548, 11017, 1963, 25, 14833, 81312, 66354, 1273, 13256, 11389, 44865, 21964, 172, 1114, 25501, 887, 1228, 3294, 36312, 10234, 863, 1691, 107739, 56800, 26356, 35011, 1286, 5561, 9801, 11578, 21969, 16864, 13044, 5423, 25281, 13050, 2882, 44747, 7235, 70682, 16534, 11433, 8, 11274, 25555, 35219, 173, 14520, 17960, 9724, 3960, 8221, 20655, 8025, 3218, 9487, 1670, 2599, 37911, 795, 12070, 61941, 16904, 2381, 5003, 11642, 67007, 229, 8973, 54877, 3500, 11087, 1011, 15582, 288, 19932, 3540, 3740, 3605, 41086, 8753, 3648, 5459, 1633, 758, 2195, 13995, 7814, 436, 15809, 33354, 26958, 111222, 103374, 7558, 5417, 28749, 39374, 46077, 12621, 9244, 55504, 1502, 18336, 22059, 15351]                                                                                                                                                                                                                    |
# |18            |[1684, 1373, 3158, 11006, 96, 1018, 3528, 6026, 323, 23159, 33690, 2026, 13818, 33777, 21162, 15130, 3913, 125, 31316, 5589, 6765, 9824, 2715, 13261, 1688, 6251, 768, 6201, 15774, 1579, 4095, 10431, 33, 66059, 13681, 1458, 11745, 3734, 25581, 3798, 5453, 51199, 13166, 3612, 1197, 2394, 239, 13400, 9072, 709, 16113, 34092, 14361, 3747, 981, 33490, 4634, 6814, 3491, 10275, 7603, 2521, 830, 19808, 8941, 7113, 18916, 6015, 21240, 4942, 7808, 14631, 1139, 20967, 7227, 823, 1053, 111, 6555, 17982, 5078, 552, 13747, 2, 6741, 23561, 7902, 86, 23027, 14767, 3436, 243, 1476, 20085, 506, 24618, 15521, 9537, 11375, 1388, 19604, 38277, 264, 473, 7112, 32, 6685, 335, 1679, 19118, 15434, 920, 11530, 9201, 2545, 63813, 6395, 3588, 1123, 275, 13, 11125, 884, 8242, 2894, 2263, 12239, 1156, 10453, 4553, 5151, 36538, 8360, 34192, 4871, 3290, 387, 16483, 21304, 16491, 2719, 7217, 15284, 30089, 5, 952, 7097, 29675, 9386, 5537, 9010, 2227, 10285, 130, 44730, 5515, 18043, 118, 512, 31109, 2410, 2899, 2194, 11479, 1403, 10295, 3749, 1589, 1154, 9729, 2144, 38816, 15849, 20165, 14722, 5664, 11795, 6298, 18714, 31537, 448, 2684, 1644, 17770, 1460, 1394, 43, 7984, 96194, 487, 1483, 1901, 588, 686, 1360, 1693, 40040, 10596, 21870, 9641, 162, 11548, 3427, 22937, 778, 1050, 29020, 22315, 1866, 324, 27863, 94391, 3079, 19766, 584, 7404, 560, 21, 385, 3642, 24830, 562, 4843, 71, 2099, 654, 1417, 417, 39781, 131529, 2140, 35027, 7139, 5127, 801, 16869, 1098, 8642, 478, 465, 3043, 4953, 5873, 2986, 48228, 68, 24715, 858, 16893, 3149, 17705, 1975, 6097, 1803, 25641, 3853, 7745, 362, 10858, 2113, 9000, 1771, 23953, 6553, 34806, 132, 59297, 5025, 791, 9502, 47844, 593, 3562, 1842, 15314, 3936, 18949, 1354, 19971, 92, 15414, 6236, 3872, 1576, 8848, 835, 23908, 16794, 1216, 632, 2731, 8518, 456, 40656, 77241, 1745, 125647, 931, 7546, 2668, 8, 4043, 1742, 65062, 4615, 12273, 3934, 1896, 13097, 3677, 2155, 29616, 94, 3498, 1554, 4137, 28853, 171, 2751, 5847, 16587, 2846, 44815, 949, 6124, 576, 15352, 4250, 6776, 81, 5084, 5238, 6086, 201, 18697, 26919, 9829, 1090, 41415, 67367, 2573, 11, 4030, 26728, 17469, 10210, 11798, 8706, 35135, 342, 197, 11747, 116, 54053, 53398]                                                                                                                                                                                                                                                                                                                                                                                                        |
# |38            |[19194, 24847, 32405, 1083, 13446, 50754, 19756, 10310, 40706, 14519, 16500, 28105, 33884, 3140, 33315, 15312, 156, 5282, 60007, 8338, 809, 22433, 4122, 1830, 7476, 22166, 7577, 5085, 89650, 20538, 8488, 5765, 27566, 3556, 9838, 2644, 12499, 10243, 11779, 2297, 22854, 28, 1728, 13729, 39674, 11632, 16113, 15826, 11243, 41876, 38841, 36730, 981, 119352, 13056, 50350, 9746, 18153, 44669, 16303, 55377, 8925, 23920, 37811, 5888, 28852, 26076, 14039, 19778, 8896, 37238, 16597, 823, 18847, 14430, 3179, 30366, 32656, 7301, 33764, 47070, 9230, 8502, 6375, 3782, 22085, 1976, 19604, 37394, 31819, 4466, 27459, 9170, 6889, 28121, 13901, 15601, 13272, 7985, 591, 18427, 6654, 25743, 20146, 9088, 4227, 1003, 9466, 19573, 3340, 8360, 18530, 88985, 2085, 4329, 80843, 111489, 18278, 11902, 12714, 22116, 49247, 27001, 30089, 19385, 9570, 7097, 24738, 14897, 8597, 22098, 8601, 13511, 29046, 23483, 21092, 13168, 30588, 35163, 15972, 4918, 2116, 6596, 3170, 1574, 8739, 161, 11930, 4549, 8781, 7161, 2776, 588, 6701, 12086, 13345, 20679, 12600, 27949, 7634, 21637, 10618, 6197, 35015, 7534, 4282, 37105, 4363, 75705, 11888, 2181, 2948, 29329, 584, 560, 1604, 28982, 17308, 14856, 7530, 48100, 4097, 23470, 11576, 17941, 6033, 8182, 10789, 2097, 2957, 17579, 8119, 10064, 1098, 13979, 17944, 3201, 40856, 16055, 9773, 1313, 52358, 14509, 24798, 14433, 17032, 36372, 40092, 1743, 15043, 16893, 19320, 4575, 11539, 25167, 41051, 31462, 18621, 27291, 2100, 9110, 5462, 73859, 45617, 27991, 8496, 172, 7061, 36503, 3562, 3936, 6964, 36521, 16364, 51719, 16996, 25343, 1933, 53672, 16794, 1396, 15887, 5683, 13570, 14746, 38563, 54530, 16534, 39231, 57838, 22824, 16793, 16163, 25770, 12273, 13097, 17097, 29616, 10024, 26370, 39441, 18292, 36039, 42265, 48291, 11323, 27139, 13165, 4597, 11362, 24062, 11481, 112844, 16071, 20206, 31566, 23141, 27364, 41685, 27778, 3536, 4108, 2404, 193, 168060, 41415, 6379, 34486, 6153, 12199, 2393, 8706, 12778, 17378, 33769, 4058, 3820, 18239, 119720, 46001, 8157, 45010, 6955]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
# +--------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+



test_metric = temp.join(test_array, on="user_label_int", how="left")

test_metric = test_metric.drop("user_label_int")
# +--------------+---------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
# |user_label_int|recommends                                   |collect_list(song_label_int)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
# +--------------+---------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
# |1142          |[23, 139, 123, 16, 154, 15, 189, 326, 13, 64]|[10987, 59, 3669, 304, 28093, 26997, 63746, 11765, 105293, 77947, 1811, 37683, 19008, 11538, 28300, 23633, 1438, 41249, 22878, 35245, 8119, 30832, 35564, 27155, 10310, 38918, 255157, 8318, 28105, 73804, 156, 6330, 6730, 39734, 40038, 31689, 3791, 44169, 40961, 2842, 97090, 8030, 31952, 45293, 39674, 42473, 14361, 36730, 9568, 35437, 10309, 305, 661, 3401, 29747, 12390, 1783, 60083, 57150, 10668, 42899, 8621, 16611, 59655, 25533, 10911, 39675, 453, 334550, 16757, 13110, 27082, 32208, 41429, 7491, 11510, 14221, 14171, 7327, 78452, 27710, 2572, 7328, 3035, 41902, 28479, 55754, 28975, 10825, 306, 1460, 30031, 4780, 42324, 22860, 4872, 23791, 209667, 529, 122485, 9415, 6296, 158, 15676, 50788, 3069, 202095, 7100, 2237, 45427, 1875, 45010, 25193, 51955, 6721, 6685, 23842, 13096, 1997, 58890, 169, 26651, 13862, 13, 1192, 32409, 20335, 8349, 26319, 56018, 39725, 33538, 33175, 5971, 2726, 23229, 7893, 7061, 2854, 14325, 26892, 20126, 1480]|
# +--------------+---------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
# only showing top 1 row



test_rdd = test_metric.rdd

from pyspark.mllib.evaluation import RankingMetrics

metrics_2 = RankingMetrics(test_rdd)


metrics_2.precisionAt(5)
#  0.06123845908946199

metrics_2.ndcgAt(10)
# 0.05557657159203472

metrics_2.meanAveragePrecision
# 0.00965199857704829
